FROM ollama/ollama:latest

# ë¡œì¼€ì¼ ë° íƒ€ìž„ì¡´ ì„¤ì • (Dockerfile.fullstack ì°¸ì¡°)
ENV LANG=ko_KR.UTF-8 \
    LANGUAGE=ko_KR:ko \
    LC_ALL=ko_KR.UTF-8 \
    TZ=Asia/Seoul

# ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œì¼€ì¼/íƒ€ìž„ì¡´ ì„¤ì •
RUN apt-get update && apt-get install -y \
    curl \
    wget \
    procps \
    locales \
    && ln -snf /usr/share/zoneinfo/$TZ /etc/localtime \
    && echo $TZ > /etc/timezone \
    && sed -i '/ko_KR.UTF-8/s/^# //g' /etc/locale.gen \
    && locale-gen \
    && rm -rf /var/lib/apt/lists/*

# Entrypoint ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (entrypoint.sh ë³‘í•©)
RUN echo '#!/bin/bash' > /entrypoint.sh && \
    echo '/bin/ollama serve &' >> /entrypoint.sh && \
    echo 'pid=$!' >> /entrypoint.sh && \
    echo 'sleep 5' >> /entrypoint.sh && \
    echo 'echo "ðŸ”´ Retrieve LLM model..."' >> /entrypoint.sh && \
    echo 'ollama pull sam860/exaone-4.0:1.2b-thinking-Q8_0' >> /entrypoint.sh && \
    echo 'ollama pull bge-m3:567m' >> /entrypoint.sh && \
    echo 'echo "ðŸŸ¢ Done!"' >> /entrypoint.sh && \
    echo 'wait $pid' >> /entrypoint.sh && \
    chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
